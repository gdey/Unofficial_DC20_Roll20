<div class="container">
	<div class="info">
		<div class="player">
			<span>Player Name</span>
			<input type="text" name="attr_playerName" placeholder="Enter Your Name">
		</div>
		<div class="name">
			<span>Character Name</span>
			<input type="text" name="attr_character_name" placeholder="Enter Your Character's Name">
		</div>
		<div class="class">
			<span>Class & Subclass</span>
			<input type="text" name="attr_class" placeholder="Class - Subclass">
		</div>
		<div class="ancestry">
			<span>Ancestry & Background</span>
			<input type="text" name="attr_ancestry" placeholder="Ancestry & Background">
		</div>
		<div class="level">
			<span>Level</span>
			<input type="number" name="attr_level" value="1" min="1">
		</div>
		<div class="cm">
			<span>Combat Mastery</span>
			<input type="text" name="attr_combatMastery" value="1" readonly>
		</div>
	</div>

	<div class="stats">
		<div class="prime-stat">
			<span>Prime</span>
			<input type="text" name="attr_prime" value="-2" readonly>
		</div>
		<div class="awareness-skill">
			<span>Awareness</span>
		</div>
		<div class="awareness-masteries-0">
			<input type="checkbox" name="attr_awarenessMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_awarenessMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_awarenessMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_awarenessMastery" value="8" title="Master">
			<input type="checkbox" name="attr_awarenessMastery" value="10" title="Grandmaster">
		</div>
		<div class="awareness-value">
			<input type="text" name="attr_awareness" value="-2" readonly>
		</div>
		<div class="might-stat">
			<span>Might</span>
			<input type="number" name="attr_might" value="-2" min="-2" />
		</div>
		<div class="might-save">
			<span>Save</span>
			<input type="text" name="attr_mightSave" value="-2" readonly>
			<input type="checkbox" name="attr_mightSaveMastery" value="1" title="Save Mastery">
		</div>
		<div class="athletics-skill">
			<span>Athletics</span>
		</div>
		<div class="athletics-masteries-0">
			<input type="checkbox" name="attr_athleticsMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_athleticsMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_athleticsMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_athleticsMastery" value="8" title="Master">
			<input type="checkbox" name="attr_athleticsMastery" value="10" title="Grandmaster">
		</div>
		<div class="athletics-value">
			<input type="text" name="attr_athletics" value="-2" readonly>
		</div>
		<div class="intimidation-skill">
			<span>Intimidation</span>
		</div>
		<div class="intimidation-masteries-1">
			<input type="checkbox" name="attr_intimidationMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_intimidationMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_intimidationMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_intimidationMastery" value="8" title="Master">
			<input type="checkbox" name="attr_intimidationMastery" value="10" title="Grandmaster">
		</div>
		<div class="intimidation-value">
			<input type="text" name="attr_intimidation" value="-2" readonly>
		</div>
		<div class="agility-stat">
			<span>Agility</span>
			<input type="number" name="attr_agility" value="-2" min="-2" />
		</div>
		<div class="agility-save">
			<span>Save</span>
			<input type="text" name="attr_agilitySave" value="-2" readonly>
			<input type="checkbox" name="attr_agilitySaveMastery" value="1" title="Save Mastery">
		</div>
		<div class="acrobatics-skill">
			<span>Acrobatics</span>
		</div>
		<div class="acrobatics-masteries-0">
			<input type="checkbox" name="attr_acrobaticsMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_acrobaticsMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_acrobaticsMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_acrobaticsMastery" value="8" title="Master">
			<input type="checkbox" name="attr_acrobaticsMastery" value="10" title="Grandmaster">
		</div>
		<div class="acrobatics-value">
			<input type="text" name="attr_acrobatics" value="-2" readonly>
		</div>
		<div class="trickery-skill">
			<span>Trickery</span>
		</div>
		<div class="trickery-masteries-1">
			<input type="checkbox" name="attr_trickeryMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_trickeryMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_trickeryMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_trickeryMastery" value="8" title="Master">
			<input type="checkbox" name="attr_trickeryMastery" value="10" title="Grandmaster">
		</div>
		<div class="trickery-value">
			<input type="text" name="attr_trickery" value="-2" readonly>
		</div>
		<div class="stealth-skill">
			<span>Stealth</span>
		</div>
		<div class="stealth-masteries-2">
			<input type="checkbox" name="attr_stealthMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_stealthMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_stealthMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_stealthMastery" value="8" title="Master">
			<input type="checkbox" name="attr_stealthMastery" value="10" title="Grandmaster">
		</div>
		<div class="stealth-value">
			<input type="text" name="attr_stealth" value="-2" readonly>
		</div>
		<div class="charisma-stat">
			<span>Charisma</span>
			<input type="number" name="attr_charisma" value="-2" min="-2" />
		</div>
		<div class="charisma-save">
			<span>Save</span>
			<input type="text" name="attr_charismaSave" value="-2" readonly>
			<input type="checkbox" name="attr_charismaSaveMastery" value="1" title="Save Mastery">
		</div>
		<div class="animal-skill">
			<span>Animal</span>
		</div>
		<div class="animal-masteries-0">
			<input type="checkbox" name="attr_animalMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_animalMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_animalMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_animalMastery" value="8" title="Master">
			<input type="checkbox" name="attr_animalMastery" value="10" title="Grandmaster">
		</div>
		<div class="animal-value">
			<input type="text" name="attr_animal" value="-2" readonly>
		</div>
		<div class="influence-skill">
			<span>Influence</span>
		</div>
		<div class="influence-masteries-1">
			<input type="checkbox" name="attr_influenceMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_influenceMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_influenceMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_influenceMastery" value="8" title="Master">
			<input type="checkbox" name="attr_influenceMastery" value="10" title="Grandmaster">
		</div>
		<div class="influence-value">
			<input type="text" name="attr_influence" value="-2" readonly>
		</div>
		<div class="insight-skill">
			<span>Insight</span>
		</div>
		<div class="insight-masteries-2">
			<input type="checkbox" name="attr_insightMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_insightMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_insightMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_insightMastery" value="8" title="Master">
			<input type="checkbox" name="attr_insightMastery" value="10" title="Grandmaster">
		</div>
		<div class="insight-value">
			<input type="text" name="attr_insight" value="-2" readonly>
		</div>
		<div class="intelligence-stat">
			<span>Intelligence</span>
			<input type="number" name="attr_intelligence" value="-2" min="-2" />
		</div>
		<div class="intelligence-save">
			<span>Save</span>
			<input type="text" name="attr_intelligenceSave" value="-2" readonly>
			<input type="checkbox" name="attr_intelligenceSaveMastery" value="1" title="Save Mastery">
		</div>
		<div class="investigation-skill">
			<span>Investigation</span>
		</div>
		<div class="investigation-masteries-0">
			<input type="checkbox" name="attr_investigationMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_investigationMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_investigationMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_investigationMastery" value="8" title="Master">
			<input type="checkbox" name="attr_investigationMastery" value="10" title="Grandmaster">
		</div>
		<div class="investigation-value">
			<input type="text" name="attr_investigation" value="-2" readonly>
		</div>
		<div class="medicine-skill">
			<span>Medicine</span>
		</div>
		<div class="medicine-masteries-1">
			<input type="checkbox" name="attr_medicineMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_medicineMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_medicineMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_medicineMastery" value="8" title="Master">
			<input type="checkbox" name="attr_medicineMastery" value="10" title="Grandmaster">
		</div>
		<div class="medicine-value">
			<input type="text" name="attr_medicine" value="-2" readonly>
		</div>
		<div class="survival-skill">
			<span>Survival</span>
		</div>
		<div class="survival-masteries-2">
			<input type="checkbox" name="attr_survivalMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_survivalMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_survivalMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_survivalMastery" value="8" title="Master">
			<input type="checkbox" name="attr_survivalMastery" value="10" title="Grandmaster">
		</div>
		<div class="survival-value">
			<input type="text" name="attr_survival" value="-2" readonly>
		</div>
		<div class="arcana-skill">
			<span>Arcana</span>
		</div>
		<div class="arcana-masteries-3">
			<input type="checkbox" name="attr_arcanaMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_arcanaMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_arcanaMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_arcanaMastery" value="8" title="Master">
			<input type="checkbox" name="attr_arcanaMastery" value="10" title="Grandmaster">
		</div>
		<div class="arcana-value">
			<input type="text" name="attr_arcana" value="-2" readonly>
		</div>
		<div class="history-skill">
			<span>History</span>
		</div>
		<div class="history-masteries-4">
			<input type="checkbox" name="attr_historyMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_historyMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_historyMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_historyMastery" value="8" title="Master">
			<input type="checkbox" name="attr_historyMastery" value="10" title="Grandmaster">
		</div>
		<div class="history-value">
			<input type="text" name="attr_history" value="-2" readonly>
		</div>
		<div class="nature-skill">
			<span>Nature</span>
		</div>
		<div class="nature-masteries-5">
			<input type="checkbox" name="attr_natureMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_natureMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_natureMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_natureMastery" value="8" title="Master">
			<input type="checkbox" name="attr_natureMastery" value="10" title="Grandmaster">
		</div>
		<div class="nature-value">
			<input type="text" name="attr_nature" value="-2" readonly>
		</div>
		<div class="occultism-skill">
			<span>Occultism</span>
		</div>
		<div class="occultism-masteries-6">
			<input type="checkbox" name="attr_occultismMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_occultismMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_occultismMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_occultismMastery" value="8" title="Master">
			<input type="checkbox" name="attr_occultismMastery" value="10" title="Grandmaster">
		</div>
		<div class="occultism-value">
			<input type="text" name="attr_occultism" value="-2" readonly>
		</div>
		<div class="religion-skill">
			<span>Religion</span>
		</div>
		<div class="religion-masteries-7">
			<input type="checkbox" name="attr_religionMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_religionMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_religionMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_religionMastery" value="8" title="Master">
			<input type="checkbox" name="attr_religionMastery" value="10" title="Grandmaster">
		</div>
		<div class="religion-value">
			<input type="text" name="attr_religion" value="-2" readonly>
		</div>
		<div class="skill-8">
			<input type="text" name="attr_skill8Name">
		</div>
		<div class="-masteries-8">
			<input type="checkbox" name="attr_skill8Mastery" value="2" title="Novice">
			<input type="checkbox" name="attr_skill8Mastery" value="4" title="Adept">
			<input type="checkbox" name="attr_skill8Mastery" value="6" title="Expert">
			<input type="checkbox" name="attr_skill8Mastery" value="8" title="Master">
			<input type="checkbox" name="attr_skill8Mastery" value="10" title="Grandmaster">
		</div>
		<div class="value-8">
			<input type="text" name="attr_skill8" value="-2" readonly>
		</div>
		<div class="skill-9">
			<input type="text" name="attr_skill9Name">
		</div>
		<div class="-masteries-9">
			<input type="checkbox" name="attr_skill9Mastery" value="2" title="Novice">
			<input type="checkbox" name="attr_skill9Mastery" value="4" title="Adept">
			<input type="checkbox" name="attr_skill9Mastery" value="6" title="Expert">
			<input type="checkbox" name="attr_skill9Mastery" value="8" title="Master">
			<input type="checkbox" name="attr_skill9Mastery" value="10" title="Grandmaster">
		</div>
		<div class="value-9">
			<input type="text" name="attr_skill9" value="-2" readonly>
		</div>
	</div>

	<div class="trades">
		<span>Trades</span>
		<fieldset class="repeating_trade">
			<input type="text" name="attr_tradeName" placeholder="Name">
			<select name="attr_tradeStat">
				<option value="none" selected disabled>Choose</option>
				<option value="might">Might</option>
				<option value="agility">Agility</option>
				<option value="charisma">Charisma</option>
				<option value="intelligence">Intelligence</option>
			</select>
			<input type="checkbox" name="attr_tradeMastery" value="2" title="Novice">
			<input type="checkbox" name="attr_tradeMastery" value="4" title="Adept">
			<input type="checkbox" name="attr_tradeMastery" value="6" title="Expert">
			<input type="checkbox" name="attr_tradeMastery" value="8" title="Master">
			<input type="checkbox" name="attr_tradeMastery" value="10" title="Grandmaster">
			<input type="text" name="attr_tradeModifier" value="0" readonly>
		</fieldset>
	</div>

	<div class="languages">
		<span>Languages</span>
		<fieldset class="repeating_language">
			<select>
				<option value="none" selected disabled>Choose</option>
				<option disabled style="background: grey; font-weight: bold; color: white;">Mortal</option>
				<option>Common</option>
				<option>Human</option>
				<option>Dwarven</option>
				<option>Elvish</option>
				<option>Gnomish</option>
				<option>Halfling</option>
				<option disabled style="background: grey; font-weight: bold; color: white;">Exotic</option>
				<option>Draconic</option>
				<option>Giant</option>
				<option>Fey</option>
				<option>Orcish</option>
				<option>Elemental</option>
				<option disabled style="background: grey; font-weight: bold; color: white;">Divine</option>
				<option>Celestial</option>
				<option>Fiend</option>
				<option disabled style="background: grey; font-weight: bold; color: white;">Outer</option>
				<option>Deep Speech</option>
			</select>
			<input type="checkbox" title="Limited">
			<input type="checkbox" title="Fluent">
		</fieldset>
	</div>

	<div class="combat-masteries">
		<span>Combat Masteries</span>
		<textarea></textarea>
	</div>

	<div class="currency">
		<span>Currency</span>
		<textarea></textarea>
	</div>

	<div class="points">
		<span>Stamina Points</span>
		<input type="number" name="attr_staminaPoints" value="0">
		<span>Max</span>
		<input type="text" name="attr_staminaPoints_max" value="0" readonly>
		<span>Mana Points</span>
		<input type="number" name="attr_manaPoints" value="0">
		<span>Max</span>
		<input type="text" name="attr_manaPoints_max" value="0" readonly>
		<span>Hit Points</span>
		<input type="number" name="attr_hitPoints" value="0">
		<span>Max</span>
		<input type="text" name="attr_hitPoints_max" value="0" readonly>

		<span>Temp</span>
		<input type="number" name="attr_tempHitPoints" value="0">
	</div>

	<div class="defenses">
		<span>Physical Defense</span>
		<input type="text" name="attr_physicalDefense" value="0" readonly>
		<span>Heavy</span>
		<input type="text" name="attr_physicalHeavy" value="0" readonly>
		<span>Brutal</span>
		<input type="text" name="attr_physicalBrutal" value="0" readonly>
		<span>Physical Damage Reduction</span>
		<input type="number" name="attr_physicalDamageReduction" value="0">
		<span>Mystical Defense</span>
		<input type="text" name="attr_mysticalDefense" value="0" readonly>
		<span>Heavy</span>
		<input type="text" name="attr_mysticalHeavy" value="0" readonly>
		<span>Brutal</span>
		<input type="text" name="attr_mysticalBrutal" value="0" readonly>
		<span>Mystical Damage Reduction</span>
		<input type="number" name="attr_mysticalDamageReduction" value="0">
	</div>

	<div class="combat">
		<span>Combat</span>
		<span>Actions Points</span>
		<input type="checkbox">
		<input type="checkbox">
		<input type="checkbox">
		<input type="checkbox">
		<span>Minor Action Point</span>
		<input type="checkbox">
		<span>Attack/Spell Check</span>
		<input type="text" name="attr_attackModifier" value="-1" readonly>
	</div>

	<div class="attacks">
		<span>Attacks</span>
		<fieldset class="repeating_attack">
			<span>Name</span>
			<input type="text" name="attr_attackName" placeholder="Name">
			<span>Damage</span>
			<input type="number" name="attr_attackDamage" value="0" min="0">
			<span>Damage Type</span>
			<input type="text" name="attr_attackType" placeholder="Damage Type">
			<span>Special</span>
			<textarea></textarea>
		</fieldset>
	</div>

	<div class="inventory">
		<span>Inventory</span>
		<fieldset class="repeating_inventory">
			<span>Name</span>
			<input type="text" placeholder="Name">
			<span>Quantity</span>
			<input type="number" name="attr_inventoryQuantity" value="1" min="1">
			<span>Weight</span>
			<input type="number" name="attr_inventoryWeight" value="0" min="0">
		</fieldset>
	</div>

	<div class="death">
		<span>Death</span>
		<span>Exhaustion</span>
		<input type="hidden" name="attr_exhaustion" value="0">
		<input type="checkbox" name="attr_exhaustion" value="-1">
		<input type="checkbox" name="attr_exhaustion" value="-2">
		<input type="checkbox" name="attr_exhaustion" value="-3">
		<input type="checkbox" name="attr_exhaustion" value="-4">
		<input type="checkbox" name="attr_exhaustion" value="-5">
		<span>Death Threshold</span>
		<input type="text" name="attr_deathThreshold" value="0" readonly>
	</div>

	<div class="move">
		<span>Move Speed</span>
		<input type="number" name="attr_move" value="0" min="0">
		<span>Jump Distance</span>
		<input type="text" name="attr_jump" value="1" min="1" readonly>
	</div>

	<div class="resources">
		<span>Resources</span>
		<span>Name</span>
		<span>Total</span>
		<span>Max</span>
		<span>Rest Points</span>
		<input type="number" name="attr_restPoints" value="0" min="0">
		<input type="text" name="attr_restPoints_max" value="0" readonly>
		<span>Grit Points</span>
		<input type="number" name="attr_gritPoints" value="0" min="0">
		<input type="text" name="attr_gritPoints_max" value="0" readonly>
		<fieldset class="repeating_resource">
			<input type="text" name="attr_resourceName" placeholder="Name">
			<input type="number" name="attr_resource" value="0" min="0">
			<input type="number" name="attr_resource_max" value="0">
		</fieldset>
	</div>

	<div class="features">
		<span>Features</span>
		<fieldset class="repeating_resource">
			<input type="text" placeholder="Name">
			<textarea></textarea>
		</fieldset>
	</div>
</div>

<script type="text/worker">
// COMBAT MASTERY and HIT POINTS
// When the level is changed, set the combat mastery
// When the level or might is changed, set the hit points
on("change:might change:level", () => {
	getAttrs(["level", "might"], values => {
		const level = +values.level || 0;
		const mastery = Math.ceil(level / 2);

		const might = +values.might || 0;
		const total = 6 + level + might;

		setAttrs({
			"combatMastery": mastery,
			"hitPoints_max": total
		});
	});
});

// STATS
// When the stats are changed, set the prime stat
on("change:might change:agility change:charisma change:intelligence", () => {
	getAttrs(["might", "agility", "charisma", "intelligence"], values => {
		const might = +values.might || 0;
		const agility = +values.agility || 0;
		const charisma = +values.charisma || 0;
		const intelligence = +values.intelligence || 0;
		const max = Math.max(might, agility, charisma, intelligence);

		setAttrs({
			"prime": max
		});
	});
});

// SAVES
// When the stats or save mastery is changed, set the save modifier
on("change:mightSaveMastery change:might", () => {
	getAttrs(["might", "combatMastery", "mightSaveMastery"], values => {
		const stat = +values.might || 0;
		const cm = +values.combatMastery || 0;
		const sm = +values.mightSaveMastery || 0;
		let total = stat;

		if (sm == 1) {
			total = stat + cm;
		}

		setAttrs({
			mightSave: total
		});
	});
});
on("change:agilitySaveMastery change:agility", () => {
	getAttrs(["agility", "combatMastery", "agilitySaveMastery"], values => {
		const stat = +values.agility || 0;
		const cm = +values.combatMastery || 0;
		const sm = +values.agilitySaveMastery || 0;
		let total = stat;

		if (sm == 1) {
			total = stat + cm;
		}

		setAttrs({
			agilitySave: total
		});
	});
});
on("change:charismaSaveMastery change:charisma", () => {
	getAttrs(["charisma", "combatMastery", "charismaSaveMastery"], values => {
		const stat = +values.charisma || 0;
		const cm = +values.combatMastery || 0;
		const sm = +values.charismaSaveMastery || 0;
		let total = stat;

		if (sm == 1) {
			total = stat + cm;
		}

		setAttrs({
			charismaSave: total
		});
	});
});
on("change:intelligenceSaveMastery change:intelligence", () => {
	getAttrs(["intelligence", "combatMastery", "intelligenceSaveMastery"], values => {
		const stat = +values.intelligence || 0;
		const cm = +values.combatMastery || 0;
		const sm = +values.intelligenceSaveMastery || 0;
		let total = stat;

		if (sm == 1) {
			total = stat + cm;
		}

		setAttrs({
			intelligenceSave: total
		});
	});
});

// SKILLS
// When the stats or skill mastery is changed, set the skill modifier
on("change:awarenessMastery change:prime", () => {
	getAttrs(["awarenessMastery", ""], values => {
		const stat = +values.prime || 0;
		const mastery = +values.awarenessMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"awareness": total
		});
	});
});
on("change:athleticsMastery change:might", () => {
	getAttrs(["athleticsMastery", "might"], values => {
		const stat = +values.might || 0;
		const mastery = +values.athleticsMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"athletics": total
		});
	});
});
on("change:intimidationMastery change:might", () => {
	getAttrs(["intimidationMastery", "might"], values => {
		const stat = +values.might || 0;
		const mastery = +values.intimidationMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"intimidation": total
		});
	});
});
on("change:acrobaticsMastery change:agility", () => {
	getAttrs(["acrobaticsMastery", "agility"], values => {
		const stat = +values.agility || 0;
		const mastery = +values.acrobaticsMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"acrobatics": total
		});
	});
});
on("change:trickeryMastery change:agility", () => {
	getAttrs(["trickeryMastery", "agility"], values => {
		const stat = +values.agility || 0;
		const mastery = +values.trickeryMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"trickery": total
		});
	});
});
on("change:stealthMastery change:agility", () => {
	getAttrs(["stealthMastery", "agility"], values => {
		const stat = +values.agility || 0;
		const mastery = +values.stealthMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"stealth": total
		});
	});
});
on("change:animalMastery change:charisma", () => {
	getAttrs(["animalMastery", "charisma"], values => {
		const stat = +values.charisma || 0;
		const mastery = +values.animalMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"animal": total
		});
	});
});
on("change:influenceMastery change:charisma", () => {
	getAttrs(["influenceMastery", "charisma"], values => {
		const stat = +values.charisma || 0;
		const mastery = +values.influenceMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"influence": total
		});
	});
});
on("change:insightMastery change:charisma", () => {
	getAttrs(["insightMastery", "charisma"], values => {
		const stat = +values.charisma || 0;
		const mastery = +values.insightMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"insight": total
		});
	});
});
on("change:investigationMastery change:intelligence", () => {
	getAttrs(["investigationMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.investigationMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"investigation": total
		});
	});
});
on("change:medicineMastery change:intelligence", () => {
	getAttrs(["medicineMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.medicineMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"medicine": total
		});
	});
});
on("change:survivalMastery change:intelligence", () => {
	getAttrs(["survivalMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.survivalMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"survival": total
		});
	});
});
on("change:arcanaMastery change:intelligence", () => {
	getAttrs(["arcanaMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.arcanaMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"arcana": total
		});
	});
});
on("change:historyMastery change:intelligence", () => {
	getAttrs(["historyMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.historyMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"history": total
		});
	});
});
on("change:natureMastery change:intelligence", () => {
	getAttrs(["natureMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.natureMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"nature": total
		});
	});
});
on("change:occultismMastery change:intelligence", () => {
	getAttrs(["occultismMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.occultismMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"occultism": total
		});
	});
});
on("change:religionMastery change:intelligence", () => {
	getAttrs(["religionMastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.religionMastery || 0;
		const total = stat + mastery;

		setAttrs({
			"religion": total
		});
	});
});
on("change:Mastery change:intelligence", () => {
	getAttrs(["Mastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.Mastery || 0;
		const total = stat + mastery;

		setAttrs({
			"": total
		});
	});
});
on("change:Mastery change:intelligence", () => {
	getAttrs(["Mastery", "intelligence"], values => {
		const stat = +values.intelligence || 0;
		const mastery = +values.Mastery || 0;
		const total = stat + mastery;

		setAttrs({
			"": total
		});
	});
});

// When custom skill mastery or intelligence is changed, set the custom skill modifiers
on("change:skill8Mastery change:skill9Mastery change:intelligence", () => {
	getAttrs(["skill8Mastery", "skill9Mastery", "intelligence"], values => {
		const mastery8 = +values.skill8Mastery || 0;
		const mastery9 = +values.skill9Mastery || 0;
		const intelligence = +values.intelligence || 0;
		const total8 = intelligence + mastery8;
		const total9 = intelligence + mastery9;

		setAttrs({
			"skill8": total8,
			"skill9": total9
		});
	});
});

// TRADES
// When the stats are changed, set the trades modifiers
on("change:might change:agility change:charisma change:intelligence", () => {
	getSectionIDs('repeating_trade', ids => {
		const trades = [];

		ids.forEach(id => trades.push({"stat": `repeating_trade_${id}_tradeStat`, "mastery": `repeating_trade_${id}_tradeMastery`, "mod": `repeating_trade_${id}_tradeModifier`}));

		for(let i = 0; i < trades.length; i++) {
			getAttrs([trades[i].stat, trades[i].mastery, trades[i].mod, "might", "agility", "charisma", "intelligence"], values => {
				const stat = values[trades[i].stat];
				const might = +values.might || 0;
				const agility = +values.agility || 0;
				const charisma = +values.charisma || 0;
				const intelligence = +values.intelligence || 0;
				const mastery = +values[trades[i].mastery] || 0;
				const total = stat == "might" ? might + mastery : stat == "agility" ? agility + mastery : stat == "charisma" ? charisma + mastery : intelligence + mastery;

				setAttrs({
					[trades[i].mod]: total
				});
			});
		}
	});
});

// When the trade stat or mastery is changed, set the trade modifier
on("change:repeating_trade:tradeStat change:repeating_trade:tradeMastery", () => {
	getAttrs(["repeating_trade_tradeStat"], values => {
		const stat = values.repeating_trade_tradeStat;

		getAttrs(["repeating_trade_tradeMastery", stat], values => {
			const statMod = +values[stat] || 0;
			const mastery = +values.repeating_trade_tradeMastery || 0;
			const total = statMod + mastery;

			setAttrs({
				"repeating_trade_tradeModifier": total
			});
		});
	});
});

// ATTACKS
// When prime or combat mastery is changed, set the attack modifier
on("change:prime change:combatMastery", () => {
	getAttrs(["prime", "combatMastery"], values => {
		const prime = +values.prime || 0;
		const cm = +values.combatMastery || 0;
		const total = prime + cm;

		setAttrs({
			"attackModifier": total
		});
	});
});

// DEFENSES
// When agility, armor bonus, or combat mastery is changed, set the physical defenses
on("change:agility change:armorBonus change:combatMastery", () => {
	getAttrs(["agility", "armorBonus", "combatMastery"], values => {
		const agility = +values.agility || 0;
		const armorBonus = +values.armorBonus || 0;
		const cm = +values.combatMastery || 0;
		const total = 8 + cm + agility + armorBonus;

		setAttrs({
			"physicalDefense": total,
			"physicalHeavy": total + 5,
			"physicalBrutal": total + 10
		});
	});
});

// When charisma, intelligence, or combat mastery is changed, set the mystical defenses
on("change:charisma change:intelligence change:combatMastery", () => {
	getAttrs(["charisma", "intelligence", "combatMastery"], values => {
		const charisma = +values.charisma || 0;
		const intelligence = +values.intelligence || 0;
		const cm = +values.combatMastery || 0;
		const total = 8 + cm + charisma + intelligence;

		setAttrs({
			"mysticalDefense": total,
			"mysticalHeavy": total + 5,
			"mysticalBrutal": total + 10
		});
	});
});

//DEATH
// When the prime is changed, set the death threshold
on("change:prime", () => {
	getAttrs(["prime"], values => {
		const prime = +values.prime || 0;
		let total = prime * -1;

		if (prime < 0) {
			total = 0;
		}

		setAttrs({
			"deathThreshold": total
		});
	});
});

// JUMP
// When the agility stat is changed, set the jump distance
on("change:agility", () => {
	getAttrs(["agility"], values => {
		const agility = +values.agility || 0;
		let total = agility;

		if (agility < 0) {
			total = 1;
		}

		setAttrs({
			"jump": total
		});
	});
});

// RESOURCES
// When the might stat or level is changed, set the rest points
on("change:might change:level", () => {
	getAttrs(["might", "level"], values => {
		const might = +values.might || 0;
		const level = +values.level || 0;
		let total = level + might;

		if (total < 0) {
			total = 0;
		}

		setAttrs({
			"restPoints_max": total
		});
	});
});

// When the charisma stat is changed, set the grit points
on("change:charisma", () => {
	getAttrs(["charisma"], values => {
		const charisma = +values.charisma || 0;
		const total = charisma + 2;

		setAttrs({
			"gritPoints_max": total
		});
	});
});
</script>